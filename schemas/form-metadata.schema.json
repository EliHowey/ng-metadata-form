{
    "$schema": "http://json-schema.org/draft-07/schema",
    "title": "Form Metadata",
    "description": "Metadata required to render an HTML form dynamically.",
    "type": "object",
    "properties": {
        "id": {
            "description": "ID for the form.",
            "type": "string"
        },
        "contents": {
            "description": "Contents of the form. This can be a series of form questions or sections.",
            "type": "array",
            "items": {
                "oneOf": [{ "$ref": "#/definitions/formQuestion" }, { "$ref": "#/definitions/formSection" }]
            },
            "minItems": 1
        }
    },
    "required": ["contents"],
    "definitions": {
        "formSection": {
            "description": "A section of a dynamic Angular form.",
            "type": "object",
            "properties": {
                "type": {
                    "const": "section"
                },
                "id": {
                    "description": "ID for the form section.",
                    "type": "string"
                },
                "title": {
                    "description": "Title of the form section.",
                    "type": "string"
                },
                "contents": {
                    "description": "Contents of the form section.",
                    "type": "array",
                    "items": {
                        "oneOf": [{ "$ref": "#/definitions/formQuestion" }, { "$ref": "#/definitions/formSection" }]
                    },
                    "minItems": 1
                }
            },
            "required": ["type", "id", "contents"]
        },
        "formQuestion": {
            "description": "A question within a dynamic Angular form.",
            "type": "object",
            "properties": {
                "type": {
                    "const": "question"
                },
                "id": {
                    "description": "ID for the form question.",
                    "type": "string"
                },
                "questionText": {
                    "description": "Display text of the form question.",
                    "type": "string"
                },
                "helpText": {
                    "description": "Help text for the form question.",
                    "type": "string"
                },
                "required": {
                    "description": "Whether the user is required to provide a response to the question.",
                    "type": "boolean"
                },
                "controls": {
                    "description": "Form controls for the question.",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/formControl"
                    },
                    "minItems": 1
                }
            },
            "required": ["type", "id", "questionText", "required", "controls"]
        },
        "formControl": {
            "description": "Metadata required to render Angular form controls dynamically.",
            "type": "object",
            "properties": {
                "id": {
                    "description": "ID of the control.",
                    "type": "string"
                },
                "type": {
                    "description": "Type of the control.",
                    "type": "string"
                },
                "label": {
                    "description": "Label for the control.",
                    "type": "string"
                },
                "helpText": {
                    "description": "Help text for the control.",
                    "type": "string"
                },
                "required": {
                    "description": "Whether the user is required to provide a value in the control.",
                    "type": "boolean"
                },
                "initialValue": {
                    "description": "Initial value of the control.",
                    "type": "string"
                }
            },
            "required": ["id", "type", "label", "required"],
            "oneOf": [
                { "$ref": "#/definitions/checkbox" },
                { "$ref": "#/definitions/date" },
                { "$ref": "#/definitions/email" },
                { "$ref": "#/definitions/phone" },
                { "$ref": "#/definitions/radio" },
                { "$ref": "#/definitions/select" },
                { "$ref": "#/definitions/text" }
            ]
        },
        "checkbox": {
            "description": "A checkbox input control.",
            "type": "object",
            "properties": {
                "type": {
                    "const": "checkbox"
                },
                "checked": {
                    "description": "Whether the checkbox is checked by default.",
                    "type": "boolean"
                }
            }
        },
        "date": {
            "description": "A date input control.",
            "type": "object",
            "properties": {
                "type": {
                    "const": "date"
                },
                "min": {
                    "description": "ISO date string for the earliest allowed date.",
                    "type": "string",
                    "examples": ["2020-10-25"]
                },
                "max": {
                    "description": "ISO date string for the latest allowed date.",
                    "type": "string",
                    "examples": ["2020-11-25"]
                }
            }
        },
        "email": {
            "description": "An email input control.",
            "type": "object",
            "properties": {
                "type": {
                    "const": "email"
                },
                "placeholder": {
                    "description": "Placeholder text for the input.",
                    "type": "string",
                    "examples": ["email@example.com"]
                }
            }
        },
        "phone": {
            "description": "A phone input control.",
            "type": "object",
            "properties": {
                "type": {
                    "const": "phone"
                }
            }
        },
        "radio": {
            "description": "A radio input control.",
            "type": "object",
            "properties": {
                "type": {
                    "const": "radio"
                },
                "value": {
                    "description": "Value of the radio option.",
                    "type": "string"
                },
                "checked": {
                    "description": "Whether the radio option is selected by default.",
                    "type": "boolean"
                }
            },
            "required": ["value"]
        },
        "select": {
            "description": "A select input control.",
            "type": "object",
            "properties": {
                "type": {
                    "const": "select"
                },
                "options": {
                    "description": "Options available to select from the control.",
                    "type": "array",
                    "items": {
                        "oneOf": [
                            { "type": "string" },
                            { "$ref": "#/definitions/option" },
                            { "$ref": "#/definitions/optgroup" }
                        ]
                    }
                }
            }
        },
        "option": {
            "description": "An option for a radio or select control.",
            "type": "object",
            "properties": {
                "label": {
                    "description": "Text content of the option.",
                    "type": "string"
                },
                "value": {
                    "description": "Value of the option. If omitted, `label` will be used as the value.",
                    "type": "string"
                },
                "selected": {
                    "description": "Whether the option is selected by default.",
                    "type": "boolean"
                },
                "disabled": {
                    "description": "Whether the option is disabled by default.",
                    "type": "boolean"
                }
            },
            "required": ["label"]
        },
        "optgroup": {
            "description": "A group of related options within a select control.",
            "type": "object",
            "properties": {
                "label": {
                    "description": "Text content of the option group.",
                    "type": "string"
                },
                "options": {
                    "description": "Options within the option group.",
                    "type": ["string", "object"],
                    "oneOf": [{ "type": "string" }, { "$ref": "#/definitions/option" }]
                },
                "disabled": {
                    "description": "Whether the option group is disabled.",
                    "type": "boolean"
                }
            },
            "required": ["label", "options"]
        },
        "text": {
            "description": "A basic text input control (`<input type=\"text\">`).",
            "type": "object",
            "properties": {
                "type": {
                    "const": "text"
                },
                "placeholder": {
                    "description": "Placeholder text for the input.",
                    "type": "string"
                }
            }
        }
    }
}
